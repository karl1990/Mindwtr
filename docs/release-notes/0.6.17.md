# Mindwtr 0.6.17

## Highlights
- Addressed high-priority reliability issues identified in the comprehensive review across cloud, core sync, MCP server, and mobile task editing.
- Improved mobile sync UX with a global sync status indicator, sync connection checks, dedicated empty states, and better accessibility labels.
- Strengthened sync correctness for attachments and store persistence (empty URI preservation, remote cleanup retry behavior, queue-flush robustness, and safer restore semantics).
- Hardened security and configuration paths with explicit cloud any-token opt-in and stricter MCP write-mode CLI handling.
- Stabilized CI and tooling by fixing watch-mode hangs in desktop tests, restoring mobile/core CI compatibility, and aligning lint/TypeScript versions.

## Core / Sync / Data Integrity
- Preserved empty attachment URIs during sqlite deserialization so pending-upload metadata is not dropped.
- Added retry tracking for failed remote attachment cleanup attempts.
- Fixed store flush behavior to continue draining newer queued saves after failures.
- Preserved task status when restoring deleted tasks.
- Improved merge edge-case handling for invalid `deletedAt`, explicit empty attachment arrays, and deep-cloned settings merges.

## Cloud / MCP / Security
- Enforced task title length validation on cloud PATCH updates.
- Required explicit opt-in for cloud any-token auth mode when auth token list is unset.
- Wrapped MCP tool failures in MCP-compatible `{ content, isError }` responses.
- Standardized MCP server write mode to `--write`.

## Mobile / Desktop UX
- Added mobile fail-safe boundary handling for task edit modal audio lifecycle errors.
- Added mobile sync status indicator, sync connection checks, and empty-state UI coverage.
- Improved mobile accessibility labels and removed hardcoded status fallback labels.
- Fixed stale sync error banners showing after switching sync backend to Off.
- Continued desktop quality improvements (archived status support, tray/dock behavior fixes, UI polish).

## Tooling / Docs / Tests
- Enabled sqlite-adapter test execution in core vitest runs.
- Aligned ESLint and TypeScript workspace versions.
- Fixed desktop CI hangs by ensuring CI test scripts run in non-watch mode.
- Updated docs and wiki references (roadmap links, developer guide table fixes, contribution docs cleanup).

## Full Change List (since 0.6.16)
- 3282ad7c fix(mobile): hide stale sync errors when backend is off
- bb0fca5a fix(ci): avoid watch-mode hangs and timer-stalled store test
- d6808c0f fix(ci): restore mobile typecheck and core bun test compatibility
- 9dbcf79f refactor(mobile): extract task edit modal helpers
- 9eab82eb feat(mobile): improve quick capture accessibility labels
- 70dc68b8 refactor(mobile): extract quick capture context helpers
- ba49b6d4 refactor(desktop): extract sync attachment helpers
- fb9d29c4 test(core): run sqlite adapter tests in vitest
- 005248bd feat(mobile): add sync connection checks and empty state component
- 55e62ea7 fix(mobile): remove hardcoded status fallback labels
- bfe3371f feat(mobile): show global sync status indicator
- 14d18fd6 chore(tooling): align lint and TypeScript versions
- 38b43c75 docs: add roadmap issue links and fix developer guide table
- 8297da7b refactor(core): share recurrence constants across apps
- d9678ca1 fix(cloud): require explicit opt-in for any-token mode
- 386d3b8d fix(mcp-server): accept only --write for write mode
- 824e2b71 fix(sync): deep-clone merged settings values
- 74afee82 fix(sync): preserve explicit empty attachment arrays
- 6d47c488 fix(sync): make invalid deletedAt fallback explicit
- e95c4700 fix(core): preserve task status on restore
- a413209d fix(core): continue flush when newer save is queued
- a312962e fix(sync): persist and retry failed remote attachment cleanup
- f630e6f0 fix(core): preserve empty attachment URIs in sqlite load
- 6271f897 fix(mobile): add fail-safe boundary for task edit modal
- 2ea632f6 fix(mcp-server): wrap tool failures in MCP error responses
- a305d154 fix(cloud): validate task title length on patch
- 81cc0239 fix(analytics): keep heartbeat failures fully silent
- 32f8a45b fix(desktop): coerce legacy ymd date format for settings UI
- bb9274c0 docs: polish contributing links and translation references
- 025bff6d docs: unify contributing guidance and remove wiki duplicate
- 6062f8eb docs: update star-and-share messaging in readmes
- 9eabdd5c feat(settings): add locale-aware date format preference
- 3d38b859 fix(desktop): persist tray close preference reliably
- 866befb8 fix(desktop): hide dock icon in macOS tray mode
- 0c1ba2e4 feat(task-edit): auto-detect text direction
- 19106990 chore(ci): stop updating homebrew tap cask
- 4ff3da7f feat(analytics): add device and locale heartbeat fields
- b7365036 feat(analytics): add daily heartbeat integration
- c2c5bbbd fix(sync): block remote writes when attachment uploads are pending
- 546279fb feat(desktop): hide empty Today\'s Focus panel
- a8814657 fix(mobile): add fullscreen preview for image attachments
- 08f85ba1 refactor(core): move i18n modules under src/i18n
- b4667ad7 docs(readme): fix CONTRIBUTING links in en and zh
- 90e5c550 docs(readme): add translation contribution link in support section
- 5e2d598c fix(desktop): default list details to off
- 0dfb6b8c refactor(core): split i18n into per-language locale files
- 1701edac fix(mobile): speed up app startup on slow Android devices
- c4c2714f docs(readme): use IzzyOnDroid shield badge in Android section
- 25ca4264 docs(readme): add IzzyOnDroid badges and install steps
- 54933ce3 refactor(mobile): unify notifications on local OSS backend
- b03b842b fix(mobile): enable local notifications in FOSS builds
- a13d1184 fix(foss): strip install-referrer permission and format metadata
- 75c21442 test(mobile): include isAIKeyRequired in ai-config mock
- 7b89069e fix(mobile): remove GPT-5 copy in FOSS reasoning hint
- 02c522de feat(calendar): add quick mark-done actions
- 56ed978b feat(desktop): add archived status option for tasks
- 4025e7a0 feat(core): default notifications off on first install
- cda1a409 fix(desktop): prevent board column border clipping
- a969089c fix(desktop): prevent clipped task selection border
- 5eb53bbf fix(mobile): remove notification settings in FOSS build
- 06905a25 fix(mobile): allow keyless local OpenAI-compatible AI
- b9c4107d fix(mobile): smooth task edit/view swipe transition
- c4c6e6d3 fix(ai): allow keyless OpenAI-compatible endpoints
- 7de504e2 fix(desktop): split AUR update checks by package type
- b0fcb94b fix(ci): preserve pkgrel for AUR checksum updates
- 6966eaa9 fix(release): require WebView2 in winget manifest
- 0f5d2512 fix(ci): update AUR source checksum generation
- 724db07b fix(linux): add appstream metainfo to appimage
- 995022d9 fix(ci): inject missing diricon into linux appimage
- f474b4c0 fix(ci): harden winget silent installer manifest
- 9bc789d4 chore(ci): default release dispatch toggles to off
- 7b616a23 fix(ci): checkout source before aur-source tag resolution
- 873cac47 fix(ci): allow post-release manual jobs when release is skipped
- 4552aff3 feat(ci): allow manual rerun of post-release jobs
- 5deade89 fix(ci): preserve aur repo ownership in srcinfo step
